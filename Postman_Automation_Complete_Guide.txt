
==============================
POSTMAN AUTOMATION COMPLETE NOTES
(Newman CLI, Postman CLI & Jenkins Pipeline)
==============================

--------------------------------
1) NEWMAN CLI (Advanced Reporting + CI Friendly)
--------------------------------

‚úÖ Use When:
- Jenkins / CI pipelines
- Fancy reports (htmlextra)
- Local automation

-----------------
Installation (One Time)
-----------------
npm install -g newman
npm install -g newman-reporter-htmlextra

-----------------
Folder Structure
-----------------
pcol/
 ‚îú‚îÄ‚îÄ Product.postman_collection.json
 ‚îú‚îÄ‚îÄ pd.json
 ‚îú‚îÄ‚îÄ workspace.postman_globals.json
 ‚îî‚îÄ‚îÄ reports/

-----------------
Basic Run
-----------------
newman run Product.postman_collection.json

-----------------
With Data + Globals
-----------------
newman run Product.postman_collection.json -d pd.json -g workspace.postman_globals.json

-----------------
Fancy HTML Report (htmlextra)
-----------------
newman run Product.postman_collection.json ^
-d pd.json ^
-g workspace.postman_globals.json ^
-r htmlextra --reporter-htmlextra-export reports/report.html

-----------------
JUnit Report (CI Friendly)
-----------------
newman run Product.postman_collection.json -r junit --reporter-junit-export reports/result.xml

--------------------------------
2) POSTMAN CLI (Cloud Sync + Simple Runs)
--------------------------------

‚úÖ Use When:
- Quick workspace runs
- Simple HTML reports
- Token sync from Postman

-----------------
Installation
-----------------
npm install -g postman-cli

-----------------
Login
-----------------
postman login --with-api-key PMAK-XXXX

-----------------
Run Collection (By ID)
-----------------
postman collection run <collection-id>

-----------------
With Data + Globals
-----------------
postman collection run <collection-id> -d pd.json -g workspace.postman_globals.json

-----------------
HTML Report
-----------------
postman collection run <collection-id> -r html --reporter-html-export report.html

-----------------
Supported Reporters
-----------------
cli, json, junit, html
(htmlextra NOT supported)

--------------------------------
3) JENKINS PIPELINE (Postman CLI)
--------------------------------

‚úÖ Use When:
- Scheduled automation
- CI/CD validation
- Build pass/fail logic

-----------------
Prerequisites
-----------------
‚úî Jenkins Installed
‚úî Node.js Installed
‚úî Postman CLI Installed
‚úî HTML Publisher Plugin Installed

-----------------
Step 1: Add Postman API Key to Jenkins
-----------------
Jenkins ‚Üí Manage Jenkins ‚Üí Credentials ‚Üí Global ‚Üí Add Credentials

Kind: Secret Text
Secret: <Your Postman API Key>
ID: postman-api-key

-----------------
Step 2: Jenkins Script Console Command (Fix HTML Reports)
-----------------
Manage Jenkins ‚Üí Script Console ‚Üí Run:

System.setProperty("hudson.model.DirectoryBrowserSupport.CSP", "")

Restart Jenkins

-----------------
Step 3: Jenkins Pipeline Script (WORKING - Windows)
-----------------

pipeline {
    agent any

    environment {
        POSTMAN_API_KEY = credentials('postman-api-key')
        WORKDIR = 'D:\automation\Api_testing\Collections & data files\pcol'
    }

    stages {

        stage('Postman Login') {
            steps {
                bat 'postman login --with-api-key %POSTMAN_API_KEY%'
            }
        }

        stage('Run Collection') {
            steps {
                bat '''
                cd /d "%WORKDIR%"
                postman collection run "39395084-978f9bf0-8288-40ad-a094-6a3146aa3bb7" ^
                -d "pd.json" ^
                -g "workspace.postman_globals.json" ^
                -r html --reporter-html-export "report.html"
                '''
            }
        }

        stage('Publish Report') {
            steps {
                publishHTML(target: [
                    allowMissing: false,
                    alwaysLinkToLastBuild: true,
                    keepAll: true,
                    reportDir: 'D:\automation\Api_testing\Collections & data files\pcol',
                    reportFiles: 'report.html',
                    reportName: 'Postman API Report'
                ])
            }
        }
    }
}

-----------------
Where Report Appears in Jenkins
-----------------
Job ‚Üí Left Sidebar ‚Üí "Postman API Report"

--------------------------------
4) JENKINS PIPELINE (Newman + Fancy Report)
--------------------------------

Best UI option üî•

-----------------
Install
-----------------
npm install -g newman newman-reporter-htmlextra

-----------------
Pipeline Script
-----------------

pipeline {
    agent any

    environment {
        WORKDIR = 'D:\automation\Api_testing\Collections & data files\pcol'
    }

    stages {

        stage('Run Collection with Newman') {
            steps {
                bat '''
                cd /d "%WORKDIR%"
                newman run "Product.postman_collection.json" ^
                -d "pd.json" ^
                -g "workspace.postman_globals.json" ^
                -r htmlextra --reporter-htmlextra-export "reports/report.html"
                '''
            }
        }

        stage('Publish Report') {
            steps {
                publishHTML(target: [
                    allowMissing: false,
                    alwaysLinkToLastBuild: true,
                    keepAll: true,
                    reportDir: 'D:\automation\Api_testing\Collections & data files\pcol\reports',
                    reportFiles: 'report.html',
                    reportName: 'Newman API Report'
                ])
            }
        }
    }
}

--------------------------------
5) COMMON ERRORS & FIXES
--------------------------------

‚ùå htmlextra not recognised ‚Üí Use Newman, not Postman CLI
‚ùå data is not recognized ‚Üí Use quotes for folders with spaces
‚ùå HTML report blank ‚Üí Run CSP fix command in Script Console
‚ùå Jenkins stage error ‚Üí Ensure steps { } block exists
‚ùå Windows curl install error ‚Üí Skip install step

--------------------------------
6) QUICK MEMORY TABLE
--------------------------------

Tool        | Best Use Case            | Fancy UI | CI Friendly
------------|--------------------------|----------|-------------
Newman      | Automation + Jenkins     | ‚úÖ       | ‚úÖ
Postman CLI | Quick workspace runs     | ‚ùå       | ‚ö†Ô∏è
Jenkins     | Production automation    | ‚úÖ       | ‚úÖ

--------------------------------
END OF NOTES
--------------------------------
